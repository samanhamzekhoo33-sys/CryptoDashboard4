<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Crypto + Gold Dashboard</title>

<style>
body{
    margin:0;
    font-family:tahoma;
    background:#0b1220;
    color:white;
}
header{
    padding:20px;
    background:#111827;
    text-align:center;
    font-size:22px;
    font-weight:bold;
}
.container{
    width:95%;
    margin:auto;
}
input{
    padding:10px;
    width:100%;
    max-width:400px;
    margin:20px 0;
    border-radius:8px;
    border:none;
}
table{
    width:100%;
    border-collapse:collapse;
}
th,td{
    padding:12px;
    border-bottom:1px solid #1f2937;
    text-align:center;
}
th{
    background:#1e293b;
}
.green{color:#22c55e;}
.red{color:#ef4444;}
tr:hover{
    background:#1e293b;
    cursor:pointer;
}
.coin-info{
    display:flex;
    align-items:center;
    justify-content:center;
    gap:8px;
}
.coin-info img{
    width:22px;
    height:22px;
}
.buttons{
    text-align:center;
    margin:20px 0;
}
button{
    padding:10px 15px;
    margin:5px;
    border:none;
    border-radius:8px;
    background:#1e293b;
    color:white;
    cursor:pointer;
}
button:hover{
    background:#334155;
}
.chart-box{
    margin-top:20px;
    width:100%;
    height:90vh;
}
#tradingview_chart{
    width:100%;
    height:100%;
}
</style>
</head>
<body>

<header>ðŸš€ Crypto + Gold + Silver Dashboard</header>

<div class="container">

<div class="buttons">
    <button onclick="loadChart('OANDA:XAUUSD')">ðŸŸ¡ Ø·Ù„Ø§</button>
    <button onclick="loadChart('OANDA:XAGUSD')">âšª Ù†Ù‚Ø±Ù‡</button>
    <button onclick="loadChart('BINANCE:BTCUSDT')">â‚¿ Ø¨ÛŒØªÚ©ÙˆÛŒÙ†</button>
</div>

<input type="text" id="search" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ Ø§Ø±Ø²..." onkeyup="filterCoins()">

<table>
<thead>
<tr>
<th>Ø§Ø±Ø²</th>
<th>Ù‚ÛŒÙ…Øª</th>
<th>24h</th>
</tr>
</thead>
<tbody id="cryptoTable"></tbody>
</table>

<div class="chart-box">
<div id="tradingview_chart"></div>
</div>

</div>

<script src="https://s3.tradingview.com/tv.js"></script>

<script>
let coins = [];

function loadChart(symbol){
    document.getElementById("tradingview_chart").innerHTML="";
    new TradingView.widget({
      "autosize": true,
      "symbol": symbol,
      "interval": "60",
      "timezone": "Etc/UTC",
      "theme": "dark",
      "style": "1",
      "locale": "en",
      "toolbar_bg": "#111827",
      "enable_publishing": false,
      "allow_symbol_change": true,
      "container_id": "tradingview_chart"
    });
}

async function fetchPrices(){
    const res = await fetch(
        "https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=30&page=1&sparkline=false"
    );
    coins = await res.json();
    displayCoins(coins);
}

function displayCoins(data){
    const table = document.getElementById("cryptoTable");
    table.innerHTML="";
    data.forEach(coin=>{
        const row = `
        <tr onclick="loadChart('BINANCE:${coin.symbol.toUpperCase()}USDT')">
        <td>
            <div class="coin-info">
                <img src="${coin.image}" alt="${coin.name}">
                ${coin.name} (${coin.symbol.toUpperCase()})
            </div>
        </td>
        <td>$${coin.current_price.toLocaleString()}</td>
        <td class="${coin.price_change_percentage_24h>=0?'green':'red'}">
        ${coin.price_change_percentage_24h.toFixed(2)}%
        </td>
        </tr>`;
        table.innerHTML += row;
    });
}

function filterCoins(){
    const search = document.getElementById("search").value.toLowerCase();
    const filtered = coins.filter(c =>
        c.name.toLowerCase().includes(search) ||
        c.symbol.toLowerCase().includes(search)
    );
    displayCoins(filtered);
}

fetchPrices();
setInterval(fetchPrices,30000);
loadChart("BINANCE:BTCUSDT");
</script>

</body>
</html>
